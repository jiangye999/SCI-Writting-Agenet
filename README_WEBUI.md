# Paper Writer - 网页界面使用指南

## 📋 目录

- [快速开始](#快速开始)
- [Tab 1: 范文风格分析](#tab-1-范文风格分析)
- [Tab 2: 文献数据库管理](#tab-2-文献数据库管理)
- [Tab 3: 一键写作（核心）](#tab-3-一键写作核心)
- [运行网页界面](#运行网页界面)
- [打包exe程序](#打包exe程序)
- [系统要求](#系统要求)
- [常见问题](#常见问题)

---

## 🚀 快速开始

### 1. 安装依赖

```bash
cd paper_writer
pip install -r requirements.txt
```

### 2. 启动API代理

确保 `http://127.0.0.1:13148/v1` API代理正在运行。

### 3. 启动网页界面

```bash
streamlit run app.py
```

---

## Tab 1: 范文风格分析

上传目标期刊的论文范文，系统自动分析其写作风格，生成风格指南。

### 上传内容
- PDF/Word/TXT格式的范文
- 建议上传3-5篇目标期刊近期发表的论文

### 功能说明
系统会分析：
- 段落结构
- 常用表达
- 学术词汇
- 格式偏好

生成的文件保存在 `output/style/` 目录。

---

## Tab 2: 文献数据库管理

导入和管理文献数据库，用于论文写作时自动引用。

### 导入文献
支持从Web of Science等导出的文献文件：
- Excel格式（.xlsx）
- 包含字段：标题、作者、年份、摘要、DOI等

### 使用流程
1. 上传文献文件
2. 系统自动解析并创建数据库
3. 保存到 `output/*.db`

---

## Tab 3: 一键写作（核心）

### 工作流程

```
┌─────────────────────────────────────────────────────────────┐
│ 📤 上传研究文档                                              │
│  1. 下载「研究内容模板.md」                                   │
│  2. 按模板整理研究内容到一个Word文档                          │
│  3. 上传Word文档（.docx）                                    │
│  4. 点击「解析文档并分析图表」                                │
└─────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────┐
│ 📋 上传文档说明                                              │
│  - 下载模板                                                  │
│  - 文档应包含：研究背景、试验设计、试验方法、结果等           │
└─────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────┐
│ 📄 文档预览与确认                                            │
│  - 显示文档内容摘要                                          │
│  - 查看AI分析的研究数据                                      │
└─────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────┐
│ 📚 选择文献库（多选）                                        │
│  - 从下拉框中选择多个文献库                                  │
│  - 显示各库文献数量                                          │
└─────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────┐
│ 📁 输出设置                                                  │
│  - 输出目录                                                  │
│  - 目标期刊                                                  │
└─────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────┐
│ 📋 任务清单                    │ 🤖 模型选择                │
│  1. 分析范文风格               │                           │
│  2. 导入文献库                 │  为每个章节选择模型：      │
│  3. 处理研究成果               │  - 引言 → GPT-4o          │
│  4. 撰写引言                   │  - 方法 → GPT-4o          │
│  5. 撰写方法                   │  - 结果 → GPT-4o          │
│  6. 撰写结果                   │  - 讨论 → Claude-Sonnet   │
│  7. 撰写讨论                   │  - 摘要 → GPT-4o          │
│  8. 撰写摘要                   │  - 结论 → Claude-Sonnet   │
│  9. 撰写结论                   │                           │
│  10. 自动整合                  │                           │
│  11. 质量检查                  │                           │
└─────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────┐
│ 🚀 开始全自动写作                                            │
└─────────────────────────────────────────────────────────────┘
```

### 研究内容模板

系统提供「研究内容模板.md」文件，包含以下结构：

1. **研究背景** - 主题、意义、研究现状
2. **试验设计** - 目的、假设、分组、样本量
3. **试验方法** - 数据收集、仪器、统计方法
4. **试验地点与环境** - 地点、条件、周期
5. **研究结果** - 数据表格、图表（直接粘贴到Word中）

### Word文档要求

- 格式：.docx
- 内容：文字、表格、图片（截图图表）
- 建议：所有内容放入一个文档

### 模型配置说明

| 章节 | 推荐模型 | 说明 |
|-----|---------|------|
| 引言 | GPT-4o | 擅长结构化写作和引用 |
| 方法 | GPT-4o | 精确描述实验步骤 |
| 结果 | GPT-4o | 准确呈现数据 |
| 讨论 | Claude-Sonnet-4.5 | 深度分析和批判性思维 |
| 摘要 | GPT-4o | 简洁总结 |
| 结论 | Claude-Sonnet-4.5 | 深度思考和展望 |

---

## 🌐 运行网页界面

### 方式1：直接运行Streamlit

```bash
cd paper_writer
streamlit run app.py
```

访问 `http://localhost:8501`

### 方式2：使用批处理文件

```bash
run_webui.bat
```

---

## 📦 打包exe程序

### 步骤1：安装PyInstaller

```bash
pip install pyinstaller
```

### 步骤2：执行打包命令

```bash
cd paper_writer

# 高级打包（无控制台窗口，添加图标）
pyinstaller --onefile --windowed --icon=icon.ico app.py
```

### 步骤3：分发

打包后的exe位于 `dist/app.exe`

**注意**：exe文件较大（约500MB-1GB），因为包含Python解释器和所有依赖。

---

## 💻 系统要求

| 配置 | 要求 |
|-----|------|
| 系统 | Windows 10/11 |
| 内存 | 4GB RAM（推荐8GB+） |
| 硬盘 | 2GB 空间（推荐10GB+） |

---

## ❓ 常见问题

### Q1: 图表无法识别？

确保图表是图片格式（截图粘贴到Word），而非嵌入的Excel图表。

### Q2: 表格分析失败？

确保表格是Word内嵌表格，而非图片。如果表格数据复杂，建议同时上传Excel源文件。

### Q3: API连接失败？

检查侧边栏API配置：
- URL: `http://127.0.0.1:13148/v1`
- API Key: 有效密钥

### Q4: 打包exe后API无法连接？

exe内部无法访问127.0.0.1。请确保API代理监听 `0.0.0.0`。

### Q5: 文献引用不准确？

文献库越丰富，引用越准确。建议在Tab 2中导入更多相关文献。

---

## 📁 项目结构

```
paper_writer/
├── app.py                      # Streamlit网页界面
├── 研究内容模板.md              # 研究内容整理模板
├── config/
│   └── config.yaml             # 配置文件
├── src/
│   ├── analyzer/               # 风格分析模块
│   ├── coordinator/            # Agent协调模块
│   │   └── multi_agent_coordinator.py
│   ├── document_processor/     # 文档处理模块
│   │   ├── simple_parser.py
│   │   └── word_analyzer.py    # Word文档分析
│   ├── integrator/             # 草稿整合模块
│   ├── literature/             # 文献数据库模块
│   └── model_router/           # 模型路由模块
├── input/                      # 输入文件目录
├── output/                     # 输出文件目录
│   ├── style/                  # 风格分析结果
│   ├── sections/               # 各章节草稿
│   └── final/                  # 最终论文
└── requirements.txt
```

---

## 📄 许可证

MIT License
