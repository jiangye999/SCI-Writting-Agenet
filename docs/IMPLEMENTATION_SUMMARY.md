# Paper Writer - å®Œæ•´å®æ–½æ€»ç»“

## ğŸ“… æ›´æ–°æ—¥æœŸï¼š2024å¹´1æœˆ

## å·²å®ŒæˆåŠŸèƒ½

### 1. Wordæ–‡æ¡£æ™ºèƒ½è§£æ

æ–°å¢ `src/document_processor/word_analyzer.py`ï¼Œæ”¯æŒï¼š

- **æ–‡æœ¬æå–**: è¯†åˆ«æ ‡é¢˜ã€æ®µè½ã€è¡¨æ ¼
- **è¡¨æ ¼è§£æ**: æå–è¡¨æ ¼æ•°æ®ç”¨äºAIåˆ†æ
- **å›¾ç‰‡è¯†åˆ«**: æå–åµŒå…¥çš„å›¾è¡¨å›¾ç‰‡
- **AIåˆ†æ**: è°ƒç”¨GPT-4oåˆ†æå›¾è¡¨å†…å®¹

#### æ ¸å¿ƒç±»

```python
class WordDocumentAnalyzer:
    def analyze_document(file_path, analyze_images=True) -> DocumentAnalysisResult:
        """å®Œæ•´è§£æWordæ–‡æ¡£"""

class DocumentAnalysisResult:
    text_elements: List[TextElement]    # æå–çš„æ–‡æœ¬
    table_elements: List[TableElement]  # æå–çš„è¡¨æ ¼
    image_elements: List[ImageElement]  # æå–çš„å›¾ç‰‡
    full_text: str                      # å®Œæ•´æ–‡æœ¬

class CorrectedContent:
    """ç”¨æˆ·ç¡®è®¤åçš„å†…å®¹ï¼Œç”¨äºè®ºæ–‡å†™ä½œ"""
    text_content: str
    table_descriptions: Dict[str, str]
    image_descriptions: Dict[str, str]
    results_data: str
```

### 2. å›¾è¡¨AIåˆ†æåŠŸèƒ½

#### è¡¨æ ¼åˆ†æ
- æ ¼å¼åŒ–ä¸ºæ˜“è¯»æ–‡æœ¬
- è°ƒç”¨AIç”Ÿæˆæè¿°
- ç”¨æˆ·å¯ä¿®æ­£ç¡®è®¤

#### å›¾ç‰‡åˆ†æ
- æå–å›¾ç‰‡å¹¶ç¼–ç ä¸ºbase64
- ä½¿ç”¨GPT-4o Visionåˆ†æ
- ç”Ÿæˆå›¾è¡¨æè¿°ï¼ˆç±»å‹ã€æ•°æ®ã€è¶‹åŠ¿ï¼‰

### 3. å¤šæ–‡çŒ®åº“é€‰æ‹©

åœ¨Tab 3ä¸­æ”¯æŒï¼š
- ä» `output/` ç›®å½•æ‰«ææ‰€æœ‰ `.db` æ–‡ä»¶
- å¤šé€‰æ–‡çŒ®åº“
- åˆå¹¶åŠ è½½æ–‡çŒ®
- æ˜¾ç¤ºæ€»æ–‡çŒ®æ•°é‡

```python
# åŠ è½½å¤šä¸ªæ–‡çŒ®åº“
selected_db_names = ["db1", "db2", "db3"]
literature_papers = []
for db_name in selected_db_names:
    db_path = f"output/{db_name}.db"
    lit_manager = LiteratureDatabaseManager(db_path)
    papers = lit_manager.search("", limit=100)
    literature_papers.extend(papers)
```

### 4. å„ç« èŠ‚æ¨¡å‹é…ç½®

åœ¨ `src/coordinator/multi_agent_coordinator.py` ä¸­å®šä¹‰ï¼š

```python
SECTION_MODEL_CONFIG = {
    "introduction": {"model": "GPT-4o", "temperature": 0.7},
    "methods": {"model": "GPT-4o", "temperature": 0.7},
    "results": {"model": "GPT-4o", "temperature": 0.7},
    "discussion": {"model": "Claude-Sonnet-4.5", "temperature": 0.7},
    "abstract": {"model": "GPT-4o", "temperature": 0.5},
    "conclusion": {"model": "Claude-Sonnet-4.5", "temperature": 0.7},
}

class MultiAgentCoordinator:
    def __init__(self, base_url, api_key, model_config=None):
        # ä½¿ç”¨æä¾›çš„æ¨¡å‹é…ç½®æˆ–é»˜è®¤é…ç½®
        self.model_config = model_config or {
            section: config["model"]
            for section, config in SECTION_MODEL_CONFIG.items()
        }
```

### 5. ç ”ç©¶å†…å®¹æ¨¡æ¿

åˆ›å»º `research_content_template.md`ï¼ŒåŒ…å«ï¼š

```
1. ç ”ç©¶èƒŒæ™¯
2. è¯•éªŒè®¾è®¡
3. è¯•éªŒæ–¹æ³•
4. è¯•éªŒåœ°ç‚¹ä¸ç¯å¢ƒ
5. ç ”ç©¶ç»“æœï¼ˆè¡¨æ ¼ã€å›¾è¡¨ï¼‰
```

ç”¨æˆ·åœ¨ç½‘é¡µç•Œé¢å¯ä¸‹è½½æ­¤æ¨¡æ¿ï¼ŒæŒ‰ç»“æ„æ•´ç†ç ”ç©¶å†…å®¹ã€‚

### 6. UIå¸ƒå±€ä¼˜åŒ–

#### Tab 3å¸ƒå±€
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ“¤ ä¸Šä¼ ç ”ç©¶æ–‡æ¡£ï¼ˆWordæ ¼å¼æ¨èï¼‰          â”‚
â”‚ [é€‰æ‹©æ–‡ä»¶] [è§£ææ–‡æ¡£å¹¶åˆ†æå›¾è¡¨]          â”‚
â”‚                                         â”‚
â”‚ âœ“ æ–‡æ¡£å·²è§£æ                            â”‚
â”‚ **æ–‡æ¡£å†…å®¹æ‘˜è¦ï¼š**                       â”‚
â”‚ - æ–‡æœ¬æ®µè½: Xä¸ª                         â”‚
â”‚ - è¡¨æ ¼: Xä¸ª                             â”‚
â”‚ - å›¾ç‰‡/å›¾è¡¨: Xä¸ª                        â”‚
â”‚                                         â”‚
â”‚ [æŸ¥çœ‹å·²ç¡®è®¤çš„ç ”ç©¶æ•°æ®]                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ“‹ ä¸Šä¼ æ–‡æ¡£è¯´æ˜                          â”‚
â”‚ [ä¸‹è½½ç ”ç©¶å†…å®¹æ¨¡æ¿]                       â”‚
â”‚ ...                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ“š é€‰æ‹©æ–‡çŒ®åº“ï¼ˆå¤šé€‰ï¼‰                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ“‹ ä»»åŠ¡æ¸…å•       â”‚ ğŸ¤– æ¨¡å‹é€‰æ‹©          â”‚
â”‚ âœ… 1. åˆ†æèŒƒæ–‡    â”‚                     â”‚
â”‚ âœ… 2. å¯¼å…¥æ–‡çŒ®    â”‚ å¼•è¨€ æ–¹æ³• ç»“æœ       â”‚
â”‚ ...               â”‚ [ä¸‹æ‹‰][ä¸‹æ‹‰][ä¸‹æ‹‰]   â”‚
â”‚                   â”‚ è®¨è®º æ‘˜è¦ ç»“è®º       â”‚
â”‚                   â”‚ [ä¸‹æ‹‰][ä¸‹æ‹‰][ä¸‹æ‹‰]   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## æ¶æ„å›¾

```
ç”¨æˆ·è¾“å…¥
    â”‚
    â”œâ”€â–º Tab 1: èŒƒæ–‡é£æ ¼åˆ†æ
    â”‚       â”‚
    â”‚       â–¼
    â”‚   é£æ ¼åˆ†æå™¨ â†’ output/style/ (é£æ ¼æŒ‡å—)
    â”‚
    â”œâ”€â–º Tab 2: æ–‡çŒ®æ•°æ®åº“
    â”‚       â”‚
    â”‚       â–¼
    â”‚   æ–‡çŒ®å¯¼å…¥ â†’ output/*.db
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Tab 3: ä¸€é”®å†™ä½œ                         â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ 1. ä¸Šä¼ Wordæ–‡æ¡£                                      â”‚    â”‚
â”‚  â”‚    - è§£ææ–‡æœ¬ã€è¡¨æ ¼ã€å›¾ç‰‡                            â”‚    â”‚
â”‚  â”‚    - AIåˆ†æå›¾è¡¨å†…å®¹                                  â”‚    â”‚
â”‚  â”‚    - ç”¨æˆ·ç¡®è®¤ä¿®æ­£                                    â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                          â”‚                                    â”‚
â”‚                          â–¼                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ 2. é€‰æ‹©æ–‡çŒ®åº“ï¼ˆå¤šé€‰ï¼‰                                â”‚    â”‚
â”‚  â”‚    - åˆå¹¶åŠ è½½æ–‡çŒ®                                    â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                          â”‚                                    â”‚
â”‚                          â–¼                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ 3. é…ç½®å„ç« èŠ‚æ¨¡å‹                                    â”‚    â”‚
â”‚  â”‚    - å¼•è¨€/æ–¹æ³•/ç»“æœ â†’ GPT-4o                        â”‚    â”‚
â”‚  â”‚    - è®¨è®º/ç»“è®º â†’ Claude-Sonnet-4.5                  â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                          â”‚                                    â”‚
â”‚                          â–¼                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ 4. MultiAgentCoordinator                            â”‚    â”‚
â”‚  â”‚    - å¼•è¨€Agent â†’ IntroductionAgent                  â”‚    â”‚
â”‚  â”‚    - æ–¹æ³•Agent â†’ MethodsAgent                       â”‚    â”‚
â”‚  â”‚    - ç»“æœAgent â†’ ResultsAgent                       â”‚    â”‚
â”‚  â”‚    - è®¨è®ºAgent â†’ DiscussionAgent                    â”‚    â”‚
â”‚  â”‚    - æ‘˜è¦Agent â†’ AbstractAgent                      â”‚    â”‚
â”‚  â”‚    - ç»“è®ºAgent â†’ ConclusionAgent                    â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                          â”‚                                    â”‚
â”‚                          â–¼                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ 5. è‰ç¨¿æ•´åˆå™¨                                        â”‚    â”‚
â”‚  â”‚    - é€»è¾‘æ£€æŸ¥                                        â”‚    â”‚
â”‚  â”‚    - æ•°æ®ä¸€è‡´æ€§éªŒè¯                                  â”‚    â”‚
â”‚  â”‚    - è¿‡æ¸¡è¯å¢å¼º                                      â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                          â”‚                                    â”‚
â”‚                          â–¼                                    â”‚
â”‚                   æœ€ç»ˆè®ºæ–‡è‰ç¨¿                                â”‚
â”‚                   output/final/final_draft.md                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## æ–‡ä»¶ç»“æ„

```
paper_writer/
â”œâ”€â”€ app.py                          # Streamlitç½‘é¡µç•Œé¢ï¼ˆä¸»å…¥å£ï¼‰
â”œâ”€â”€ research_content_template.md      # ç ”ç©¶å†…å®¹æ•´ç†æ¨¡æ¿
â”œâ”€â”€ README.md                       # é¡¹ç›®è¯´æ˜
â”œâ”€â”€ README_WEBUI.md                 # ç½‘é¡µç•Œé¢ä½¿ç”¨æŒ‡å—
â”œâ”€â”€ config/
â”‚   â””â”€â”€ config.yaml
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ main.py                     # CLIå…¥å£
â”‚   â”œâ”€â”€ analyzer/
â”‚   â”‚   â””â”€â”€ journal_style_analyzer.py
â”‚   â”œâ”€â”€ coordinator/
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â””â”€â”€ multi_agent_coordinator.py  # æ ¸å¿ƒï¼šå¤šAgentåè°ƒ
â”‚   â”œâ”€â”€ document_processor/         # æ–°å¢æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ simple_parser.py        # ç®€å•æ–‡æ¡£è§£æ
â”‚   â”‚   â””â”€â”€ word_analyzer.py        # Wordæ–‡æ¡£åˆ†æï¼ˆå«å›¾è¡¨ï¼‰
â”‚   â”œâ”€â”€ integrator/
â”‚   â”‚   â””â”€â”€ draft_integrator.py
â”‚   â”œâ”€â”€ literature/
â”‚   â”‚   â””â”€â”€ db_manager.py
â”‚   â””â”€â”€ model_router/
â”‚       â””â”€â”€ model_router.py
â”œâ”€â”€ input/                          # è¾“å…¥ç›®å½•
â”œâ”€â”€ sample_papers/                  # é£æ ¼åˆ†æèŒƒæ–‡ï¼ˆPDFè®ºæ–‡ï¼‰
â”œâ”€â”€ literature_exports/             # Web of Scienceæ–‡çŒ®å¯¼å‡º
â”œâ”€â”€ output/                         # è¾“å‡ºç›®å½•
â”‚   â”œâ”€â”€ style/                      # é£æ ¼åˆ†æç»“æœ
â”‚   â”‚   â”œâ”€â”€ style_summary.md
â”‚   â”‚   â”œâ”€â”€ abstract_guide.md
â”‚   â”‚   â”œâ”€â”€ introduction_guide.md
â”‚   â”‚   â”œâ”€â”€ methods_guide.md
â”‚   â”‚   â”œâ”€â”€ results_guide.md
â”‚   â”‚   â”œâ”€â”€ discussion_guide.md
â”‚   â”‚   â””â”€â”€ conclusion_guide.md
â”‚   â”œâ”€â”€ sections/                   # å„ç« èŠ‚è‰ç¨¿
â”‚   â”œâ”€â”€ final/                      # æœ€ç»ˆè®ºæ–‡
â”‚   â””â”€â”€ *.db                        # æ–‡çŒ®æ•°æ®åº“
â””â”€â”€ requirements.txt
```

## æˆæœ¬ä¼°ç®—

| ç¯èŠ‚ | æ¨¡å‹ | æˆæœ¬/1K tokens | é¢„ä¼°ç”¨é‡ |
|-----|------|---------------|---------|
| å›¾è¡¨åˆ†æ | GPT-4o Vision | $0.02 | ~50K tokens |
| è¡¨æ ¼åˆ†æ | GPT-4o | $0.02 | ~20K tokens |
| å¼•è¨€å†™ä½œ | GPT-4o | $0.02 | ~30K tokens |
| æ–¹æ³•å†™ä½œ | GPT-4o | $0.02 | ~30K tokens |
| ç»“æœå†™ä½œ | GPT-4o | $0.02 | ~30K tokens |
| è®¨è®ºå†™ä½œ | Claude-Sonnet-4.5 | $0.018 | ~40K tokens |
| æ‘˜è¦å†™ä½œ | GPT-4o | $0.01 | ~15K tokens |
| ç»“è®ºå†™ä½œ | Claude-Sonnet-4.5 | $0.018 | ~20K tokens |

**æ€»è®¡**: çº¦ $0.004-0.008/ç¯‡

## ä¸‹ä¸€æ­¥ä¼˜åŒ–

1. âœ… Wordæ–‡æ¡£è§£æå’Œå›¾è¡¨åˆ†æ
2. âœ… å¤šæ–‡çŒ®åº“é€‰æ‹©
3. âœ… å„ç« èŠ‚æ¨¡å‹é…ç½®
4. ğŸ”„ ä¼˜åŒ–å›¾è¡¨è¯†åˆ«å‡†ç¡®ç‡
5. ğŸ”„ æ·»åŠ æ›´å¤šæ¨¡æ¿æ ¼å¼
6. ğŸ”„ æ”¯æŒPDFæ–‡æ¡£ç›´æ¥è§£æ
